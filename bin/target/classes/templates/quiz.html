<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
	<script src="https://code.angularjs.org/1.8.2/angular-sanitize.min.js"></script>

	<title>Insert title here</title>
	<style type="text/css">
		.bold-text {
			color: green;
			font-weight: bold;
		}

		.red-text {
			color: red;
		}
	</style>

	<script>
		function loadScript(src, callback) {
			var scriptElement = document.createElement('script');
			scriptElement.src = src;
			scriptElement.onload = callback;
			document.head.appendChild(scriptElement);
		}

		// Lấy tên môn học được chọn từ localStorage
		var selectedSubject = localStorage.getItem('selectedSubject');

		// Kiểm tra nếu có môn học được chọn
		if (selectedSubject) {
			// Tải tệp JavaScript tương ứng dựa trên môn học được chọn
			loadScript(selectedSubject + '.js', function () {
				// Sau khi tệp JavaScript đã tải xong, cập nhật dữ liệu trong AngularJS
				$scope.$apply(function () {
					// Cập nhật dữ liệu hoặc thực hiện các hành động khác ở đây
				});
			});
		}
	</script>

	<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
	<!-- thư viện chụp màng hình trực tuyến -->

</head>

<body ng-app="myapp">
	<div th:replace="header.html"></div>

	<div class="container-fluid mb-5">
		<div class="row border-top px-xl-5">
			<!-- Navbar Start -->
			<div th:replace="nav.html"></div>
			<div class="col-lg-9">
				<div th:replace="nav1.html"></div>
				<!-- Navbar End -->

				<!--ARTICLE ở đây -->
				<div class="border box">
					<div class="container mt-3">
						<div ng-controller="myctrl">
							<form name="myform" id="quiz-form">
								<h3 class="text-danger font-weight-bold-small px-3 mr-1 " style="text-align: center">Đề
									thi THPT quốc gia <span id="ten" th:text="${ten1}"></span>
								</h3>

								<div id="countdown" style="text-align: center">
									Thời gian làm bài: <span id="timeLeft" th:text="${timeq}"></span>
								</div>


								<hr>

								<div ng-repeat="sv in users.slice((currentPage-1)*50, currentPage*50)">

									<div ng-bind-html="sv.ten">{{sv.ten}}<br></div>
									<div ng-if="sv.anh">
										<img src="{{sv.anh}}"><br>
									</div>


									<div ng-repeat="v in sv.Answers">
										<input type="radio" ng-model="sv.selectedAnswer" ng-value="v.value"
											name="{{v.name}}">
										<span
											ng-class="{ 'bold-text': v.isCorrect,'red-text': sv.isUserAnswer === v.value && sv.isUserAnswer !== sv.kq }"
											ng-bind-html="v.Text">{{v.Text}}</span>
										<span ng-if="v.question1">
											<img src="{{v.question1}}">
										</span>
										</br>
									</div>
									<br>

									<div ng-if="sv.da" ng-model="sv.nd" ng-show="showExplanation">
										<img src="{{sv.da}}"><br>

									</div>
									<div style="font-weight: bold" ng-model="sv.nd" ng-show="showExplanationnd"
										ng-bind-html="sv.nd">
										{{sv.nd}}</div>
								</div>
								<input type="button" value="Submit" ng-click="check()" ng-hide="submitButtonVisible" />
								<input type="button" value="Thoát" ng-click="exit()" ng-hide="!submitButtonVisible" />
								<input type="button" value="chụp màn hình" ng-click="captureScreenshot()"
									ng-hide="!submitButtonVisible" />
							</form>
						</div>

					</div>
				</div>
			</div>
		</div>


		<!-- Footer Start -->
		<div th:replace="footer.html"></div>
		<!-- Footer End -->


		<!-- Back to Top -->
		<a href="#" class="btn btn-primary back-to-top"><i class="fa fa-angle-double-up"></i></a>


		<!-- JavaScript Libraries -->
		<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>

		<!-- Contact Javascript File -->
		<script src="selectedSubject"></script>
		<script src="test.js"></script>

		<script>
			// Lấy thời gian ban đầu từ localStorage
			var selectedThoiGian = localStorage.getItem('selectthoigian');
			var selectten = localStorage.getItem('selecteten');
			var ten1 = selectten;
			document.getElementById("ten").innerHTML = ten1;


			// Sử dụng giá trị thời gian để hiển thị trong trang quiz
			var timeq = selectedThoiGian;

			// Hiển thị thời gian ban đầu
			document.getElementById("timeLeft").innerHTML = timeq;

			// Chuyển đổi thời gian thành phút và giây
			var minutes = parseInt(timeq.split(':')[0]);
			var seconds = parseInt(timeq.split(':')[1]);

			// Cập nhật thời gian mỗi giây
			var countdown = setInterval(function () {
				// Hiển thị thời gian
				document.getElementById("timeLeft").innerHTML = minutes + ":" + (seconds < 10 ? "0" : "") + seconds;

				// Giảm thời gian còn lại
				if (seconds > 0) {
					seconds--;
				} else if (minutes > 0) {
					minutes--;
					seconds = 59;
				}

				// Kiểm tra nếu thời gian hết
				if (minutes === 0 && seconds === 0) {
					clearInterval(countdown);
					document.getElementById("timeLeft").innerHTML = "Hết giờ";
					// Thực hiện các hành động khi hết giờ (nếu cần)
				}
			}, 1000); // Cập nhật mỗi 1000 milliseconds (1 giây)


		</script>

		<!-- Template Javascript -->



</body>

</html>